<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>營養標示驗證網站</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      padding: 20px;
      background-color: #f8f9fa;
    }
    .container {
      max-width: 700px;
      margin: auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      text-align: center;
    }
    h2 {
      background: #f8d7da;
      padding: 10px;
      border-radius: 5px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      border: 2px solid black;
    }
    th, td {
      border: 1px solid black;
      padding: 12px;
      word-wrap: break-word;
      vertical-align: middle;
    }
    th {
      background-color: #f2f2f2;
      text-align: center;
    }
    /* 輸入框與下拉選單設為彈性寬度，並設定最小寬度 */
    td input, select {
      width: auto;
      min-width: 100px;
      padding: 5px;
      margin: auto;
      font-size: 14px;
    }
    /* 針對公克/毫升下拉選單縮小寬度 */
    #unitSelector {
      width: 60px !important;
      min-width: 60px !important;
      padding: 3px !important;
      font-size: 14px !important;
    }
    button {
      width: 100%;
      padding: 10px;
      background: #28a745;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 10px;
    }
    button:hover {
      background: #218838;
    }
    #result {
      margin-top: 15px;
      text-align: left;
      font-weight: bold;
      white-space: pre-wrap;
    }
    .validation-result {
      margin: 2px 0;
      padding: 5px;
      border-radius: 3px;
    }
    .valid {
      background-color: #d4edda;
      color: #155724;
    }
    .warning {
      background-color: #fff3cd;
      color: #856404;
    }
    .invalid {
      background-color: #f8d7da;
      color: #721c24;
    }
    .align-left {
      text-align: left;
    }
    .align-right {
      text-align: right;
    }
    .nutrient-name {
      font-weight: bold;
    }
    /* 刪除按鈕 */
    .deleteButton {
      margin-left: 10px;
      padding: 5px;
      background-color: #dc3545;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 14px;
    }
    .deleteButton:hover {
      background-color: #c82333;
    }
    /* 新增營養素按鈕 */
    #addNutrientButton {
      width: auto;
      padding: 10px 20px;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 10px;
    }
    #addNutrientButton:hover {
      background: #0069d9;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>營養標示</h2>
    <table id="nutritionTable">
      <tr>
        <th colspan="3">營養標示</th>
      </tr>
      <tr>
        <td colspan="3" style="text-align: left;">
          每一份量 
          <input type="number" id="servingSize" placeholder="公克或毫升" step="0.1" oninput="syncUnit()">
          <select id="unitSelector" onchange="syncUnit()">
            <option value="公克">公克</option>
            <option value="毫升">毫升</option>
          </select>
          <br>
          本包裝含 
          <input type="number" id="packageContain" placeholder="份數">
        </td>
      </tr>
      <tr>
        <th style="width: 20%;" class="align-left">營養素</th>
        <th style="width: 40%;" class="align-right">每份</th>
        <th style="width: 40%;" class="align-right">每100<span id="unitDisplay">公克</span></th>
      </tr>
      <!-- 固定營養素 -->
      <tr>
        <td class="align-left"><span class="nutrient-name">熱量</span></td>
        <td class="align-right"><input type="number" id="perServing_1" step="0.1"> 大卡</td>
        <td class="align-right"><input type="number" id="per100g_1" step="0.1"> 大卡</td>
      </tr>
      <tr>
        <td class="align-left"><span class="nutrient-name">蛋白質</span></td>
        <td class="align-right"><input type="number" id="perServing_2" step="0.1"> 公克</td>
        <td class="align-right"><input type="number" id="per100g_2" step="0.1"> 公克</td>
      </tr>
      <tr>
        <td class="align-left"><span class="nutrient-name">脂肪</span></td>
        <td class="align-right"><input type="number" id="perServing_3" step="0.1"> 公克</td>
        <td class="align-right"><input type="number" id="per100g_3" step="0.1"> 公克</td>
      </tr>
      <tr>
        <td class="align-left"><span class="nutrient-name">飽和脂肪</span></td>
        <td class="align-right"><input type="number" id="perServing_4" step="0.1"> 公克</td>
        <td class="align-right"><input type="number" id="per100g_4" step="0.1"> 公克</td>
      </tr>
      <tr>
        <td class="align-left"><span class="nutrient-name">反式脂肪</span></td>
        <td class="align-right"><input type="number" id="perServing_5" step="0.1"> 公克</td>
        <td class="align-right"><input type="number" id="per100g_5" step="0.1"> 公克</td>
      </tr>
      <tr>
        <td class="align-left"><span class="nutrient-name">碳水化合物</span></td>
        <td class="align-right"><input type="number" id="perServing_6" step="0.1"> 公克</td>
        <td class="align-right"><input type="number" id="per100g_6" step="0.1"> 公克</td>
      </tr>
      <tr>
        <td class="align-left"><span class="nutrient-name">糖</span></td>
        <td class="align-right"><input type="number" id="perServing_7" step="0.1"> 公克</td>
        <td class="align-right"><input type="number" id="per100g_7" step="0.1"> 公克</td>
      </tr>
      <tr>
        <td class="align-left"><span class="nutrient-name">鈉</span></td>
        <td class="align-right"><input type="number" id="perServing_8" step="0.1"> 毫克</td>
        <td class="align-right"><input type="number" id="per100g_8" step="0.1"> 毫克</td>
      </tr>
      <!-- 額外新增營養素 -->
      <tbody id="extraNutrients"></tbody>
    </table>

    <!-- 新增營養素與驗證按鈕 -->
    <button type="button" id="addNutrientButton" onclick="addExtraNutrient()">新增營養素</button>
    <button onclick="validateNutrientData()">驗證標示</button>
    <div id="result"></div>
  </div>

  <script>
    // 定義固定營養素、單位與額外營養素清單
    const nutrientNames = ["熱量", "蛋白質", "脂肪", "飽和脂肪", "反式脂肪", "碳水化合物", "糖", "鈉"];
    const fixedNutrientsUnit = {
      "熱量": "大卡",
      "蛋白質": "公克",
      "脂肪": "公克",
      "飽和脂肪": "公克",
      "反式脂肪": "公克",
      "碳水化合物": "公克",
      "糖": "公克",
      "鈉": "毫克"
    };
    const extraNutrientsList = {
      "膳食纖維": "公克",
      "赤藻糖醇": "公克",
      "糖醇": "公克",
      "有機酸": "公克",
      "酒精": "公克"
    };

    // 同步「每100公克/毫升」標題單位
    function syncUnit() {
      let unit = document.getElementById("unitSelector").value;
      document.getElementById("unitDisplay").innerText = unit;
    }

    // 計算小數點位數
    function countDecimalPlaces(valueStr) {
      if (valueStr.indexOf('.') !== -1) {
        return valueStr.split('.')[1].length;
      }
      return 0;
    }

    // 驗證數值格式，並依據營養素給予建議
    function checkNutrientDecimal(valueStr, nutrientName) {
      if (valueStr.trim() === "") return "";
      let num = parseFloat(valueStr);
      if (isNaN(num)) return "";
      let suggestion = "";
      const vitaminsAndMinerals = [
        "維生素A", "維生素B1", "維生素B2", "維生素B6", "維生素B12",
        "維生素C", "維生素D", "維生素E", "維生素K", "菸鹼素",
        "葉酸", "泛酸", "生物素", "膽素",
        "鈣", "磷", "鐵", "碘", "鎂", "鋅"
      ];
      if (vitaminsAndMinerals.includes(nutrientName)) {
        let digits = valueStr.replace('.', '').replace(/^0+/, '');
        if (digits.length > 3) {
          suggestion = nutrientName + " 建議標示為有效位數3位";
        }
      } else {
        let decimalCount = countDecimalPlaces(valueStr);
        if (decimalCount > 2) {
          suggestion = nutrientName + " 建議標示為整數或小數點後1位";
        }
      }
      return suggestion;
    }

    // 新增額外營養素
    function addExtraNutrient() {
      let extraTbody = document.getElementById("extraNutrients");
      let newRow = document.createElement("tr");
      newRow.className = "extra-nutrient-row";
      
      let cell1 = document.createElement("td");
      cell1.className = "align-left";
      let nutrientSelect = document.createElement("select");
      nutrientSelect.className = "extra-nutrient-select";
      let defaultOption = document.createElement("option");
      defaultOption.value = "";
      defaultOption.text = "請選擇營養素";
      nutrientSelect.appendChild(defaultOption);
      for (let nutrient in extraNutrientsList) {
        let option = document.createElement("option");
        option.value = nutrient;
        option.text = nutrient;
        nutrientSelect.appendChild(option);
      }
      let deleteBtn = document.createElement("button");
      deleteBtn.type = "button";
      deleteBtn.innerText = "刪除";
      deleteBtn.className = "deleteButton";
      deleteBtn.onclick = function() { removeExtraNutrient(this); };
      cell1.appendChild(nutrientSelect);
      cell1.appendChild(deleteBtn);
      
      let cell2 = document.createElement("td");
      cell2.className = "align-right";
      let servingInput = document.createElement("input");
      servingInput.type = "number";
      servingInput.step = "0.1";
      servingInput.className = "extra-nutrient-serving";
      let servingUnitSpan = document.createElement("span");
      servingUnitSpan.className = "extra-nutrient-serving-unit";
      cell2.appendChild(servingInput);
      cell2.appendChild(document.createTextNode(" "));
      cell2.appendChild(servingUnitSpan);
      
      let cell3 = document.createElement("td");
      cell3.className = "align-right";
      let per100Input = document.createElement("input");
      per100Input.type = "number";
      per100Input.step = "0.1";
      per100Input.className = "extra-nutrient-per100";
      let per100UnitSpan = document.createElement("span");
      per100UnitSpan.className = "extra-nutrient-per100-unit";
      cell3.appendChild(per100Input);
      cell3.appendChild(document.createTextNode(" "));
      cell3.appendChild(per100UnitSpan);
      
      newRow.appendChild(cell1);
      newRow.appendChild(cell2);
      newRow.appendChild(cell3);
      
      extraTbody.appendChild(newRow);
      
      nutrientSelect.addEventListener("change", function() {
        let selectedNutrient = nutrientSelect.value;
        if (selectedNutrient !== "") {
          let unit = extraNutrientsList[selectedNutrient];
          servingUnitSpan.innerText = unit;
          per100UnitSpan.innerText = unit;
        } else {
          servingUnitSpan.innerText = "";
          per100UnitSpan.innerText = "";
        }
      });
    }

    // 刪除額外營養素行
    function removeExtraNutrient(button) {
      let row = button.parentNode.parentNode;
      row.parentNode.removeChild(row);
    }

    // 驗證熱量計算（格式與其他營養素驗證一致）
    function validateCalorieSum() {
      let servingSize = parseFloat(document.getElementById("servingSize").value);
      let declaredCalorieServingStr = document.getElementById("perServing_1").value;
      let declaredCalorie100Str = document.getElementById("per100g_1").value;
      if (declaredCalorieServingStr.trim() === "" || declaredCalorie100Str.trim() === "" || isNaN(servingSize)) {
        return;
      }
      let declaredCalorieServing = parseFloat(declaredCalorieServingStr);
      let declaredCalorie100 = parseFloat(declaredCalorie100Str);

      let proteinServing = parseFloat(document.getElementById("perServing_2").value);
      let fatServing = parseFloat(document.getElementById("perServing_3").value);
      let carbServing = parseFloat(document.getElementById("perServing_6").value);
      let protein100 = parseFloat(document.getElementById("per100g_2").value);
      let fat100 = parseFloat(document.getElementById("per100g_3").value);
      let carb100 = parseFloat(document.getElementById("per100g_6").value);

      if (isNaN(proteinServing) || isNaN(fatServing) || isNaN(carbServing) ||
          isNaN(protein100) || isNaN(fat100) || isNaN(carb100)) {
        return;
      }

      let fiberServing = 0, alloseServing = 0, sugarAlcoholServing = 0, organicAcidServing = 0, alcoholServing = 0;
      let fiber100 = 0, allose100 = 0, sugarAlcohol100 = 0, organicAcid100 = 0, alcohol100 = 0;
      let extraRows = document.querySelectorAll(".extra-nutrient-row");
      extraRows.forEach(function(row) {
         let nutrientSelect = row.querySelector(".extra-nutrient-select");
         if (!nutrientSelect) return;
         let nutrientName = nutrientSelect.value;
         let servingValueInput = row.querySelector(".extra-nutrient-serving");
         let per100ValueInput = row.querySelector(".extra-nutrient-per100");
         if (servingValueInput.value.trim() !== "") {
            let val = parseFloat(servingValueInput.value);
            if (!isNaN(val)) {
               switch (nutrientName) {
                 case "膳食纖維":
                   fiberServing += val;
                   break;
                 case "赤藻糖醇":
                   alloseServing += val;
                   break;
                 case "糖醇":
                   sugarAlcoholServing += val;
                   break;
                 case "有機酸":
                   organicAcidServing += val;
                   break;
                 case "酒精":
                   alcoholServing += val;
                   break;
                 default:
                   break;
               }
            }
         }
         if (per100ValueInput.value.trim() !== "") {
            let val = parseFloat(per100ValueInput.value);
            if (!isNaN(val)) {
               switch (nutrientName) {
                 case "膳食纖維":
                   fiber100 += val;
                   break;
                 case "赤藻糖醇":
                   allose100 += val;
                   break;
                 case "糖醇":
                   sugarAlcohol100 += val;
                   break;
                 case "有機酸":
                   organicAcid100 += val;
                   break;
                 case "酒精":
                   alcohol100 += val;
                   break;
                 default:
                   break;
               }
            }
         }
      });

      let effectiveCarbServing = Math.max(0, carbServing - (fiberServing + alloseServing + sugarAlcoholServing + organicAcidServing + alcoholServing));
      let effectiveCarb100 = Math.max(0, carb100 - (fiber100 + allose100 + sugarAlcohol100 + organicAcid100 + alcohol100));

      let computedCalorieServing = proteinServing * 4 + fatServing * 9 + effectiveCarbServing * 4 +
                                   (fiberServing * 2) + (alloseServing * 0) + (sugarAlcoholServing * 2.4) +
                                   (organicAcidServing * 3) + (alcoholServing * 7);
      let computedCalorie100 = protein100 * 4 + fat100 * 9 + effectiveCarb100 * 4 +
                               (fiber100 * 2) + (allose100 * 0) + (sugarAlcohol100 * 2.4) +
                               (organicAcid100 * 3) + (alcohol100 * 7);

      let derivedServingFrom100 = computedCalorie100 / (100 / servingSize);
      let decimals100 = declaredCalorie100Str.indexOf('.') !== -1 ? declaredCalorie100Str.split('.')[1].length : 0;
      let decimalsServing = declaredCalorieServingStr.indexOf('.') !== -1 ? declaredCalorieServingStr.split('.')[1].length : 0;

      function roundToPrecision(value, precision) {
         return Number(value.toFixed(precision));
      }
      let roundedComputed100 = roundToPrecision(computedCalorie100, decimals100);
      let roundedDeclared100 = roundToPrecision(declaredCalorie100, decimals100);
      let roundedComputedServing = roundToPrecision(computedCalorieServing, decimalsServing);
      let roundedDerivedServing = roundToPrecision(derivedServingFrom100, decimalsServing);
      let roundedDeclaredServing = roundToPrecision(declaredCalorieServing, decimalsServing);

      let resultDiv = document.getElementById("result");

      // 驗證每100公克/毫升熱量
      if (roundedComputed100 !== roundedDeclared100) {
        let resultText = `❌ 每100公克/毫升熱量驗證不符合。建議每100公克/毫升熱量應為 ${roundedComputed100.toFixed(1)} 大卡。`;
        let calorieResultElement = document.createElement("div");
        calorieResultElement.className = "validation-result invalid";
        calorieResultElement.innerHTML = resultText;
        resultDiv.appendChild(calorieResultElement);
      } else {
        let resultText = `✅ 每100公克/毫升熱量驗證皆符合 (${declaredCalorie100} 大卡)。`;
        let calorieResultElement = document.createElement("div");
        calorieResultElement.className = "validation-result valid";
        calorieResultElement.innerHTML = resultText;
        resultDiv.appendChild(calorieResultElement);
      }

      // 驗證每份熱量
      if (roundedDeclaredServing === roundedComputedServing || roundedDeclaredServing === roundedDerivedServing) {
        let resultText = `✅ 每份熱量驗證皆符合 (${declaredCalorieServing} 大卡)。`;
        let calorieResultElement = document.createElement("div");
        calorieResultElement.className = "validation-result valid";
        calorieResultElement.innerHTML = resultText;
        resultDiv.appendChild(calorieResultElement);
      } else {
        let resultText = `❌ 每份熱量驗證不符合。建議每份熱量應為 ${roundedDerivedServing.toFixed(1)} 大卡。`;
        let calorieResultElement = document.createElement("div");
        calorieResultElement.className = "validation-result invalid";
        calorieResultElement.innerHTML = resultText;
        resultDiv.appendChild(calorieResultElement);
      }
    }

    // 其他驗證公式（預留擴充）
    function validateAdditionalFormulas() {
      // TODO: 擴充其他驗證公式
    }

    // 主驗證函式：檢查固定營養素與額外營養素
    function validateNutrientData() {
      let servingSize = parseFloat(document.getElementById("servingSize").value);
      let resultDiv = document.getElementById("result");
      resultDiv.innerHTML = "";

      if (document.getElementById("servingSize").value.trim() === "" || isNaN(servingSize) || servingSize <= 0) {
        resultDiv.innerHTML = "<div class='validation-result invalid'>❌ 請輸入有效的每一份量</div>";
        return;
      }

      let validCount = 0;
      let warningCount = 0;
      let invalidCount = 0;

      // 驗證固定營養素
      for (let i = 1; i <= nutrientNames.length; i++) {
        let servingValueInput = document.getElementById(`perServing_${i}`);
        let per100ValueInput = document.getElementById(`per100g_${i}`);
        if (servingValueInput.value.trim() !== "" && per100ValueInput.value.trim() !== "") {
          let suggestion = checkNutrientDecimal(servingValueInput.value, nutrientNames[i-1]);
          if (suggestion !== "") {
            resultDiv.innerHTML += "<div class='validation-result warning'>⚠️ " + suggestion + "（每份）</div>";
          }
          suggestion = checkNutrientDecimal(per100ValueInput.value, nutrientNames[i-1]);
          if (suggestion !== "") {
            resultDiv.innerHTML += "<div class='validation-result warning'>⚠️ " + suggestion + "（每100" + document.getElementById("unitDisplay").innerText + "）</div>";
          }
          
          let nutrientPerServing = parseFloat(servingValueInput.value);
          let nutrientPer100 = parseFloat(per100ValueInput.value);
          if (isNaN(nutrientPerServing) || isNaN(nutrientPer100)) {
            let resultText = `❌ <b>${nutrientNames[i-1]}</b>: 輸入的數值錯誤`;
            invalidCount++;
            servingValueInput.style.border = "2px solid red";
            let resultElement = document.createElement("div");
            resultElement.className = "validation-result invalid";
            resultElement.innerHTML = resultText;
            resultDiv.appendChild(resultElement);
          } else {
            let precision = (servingValueInput.value.split(".")[1] || "").length;
            let computedValue = nutrientPer100 / (100 / servingSize);
            function roundToPrecision(value, precision) {
              return Number(value.toFixed(precision));
            }
            let roundedComputed = roundToPrecision(computedValue, precision);
            if (roundToPrecision(nutrientPerServing, precision) === roundedComputed) {
              let resultText = `✅ <b>${nutrientNames[i-1]}</b>: 完全符合 (${nutrientPerServing})`;
              validCount++;
              servingValueInput.style.border = "1px solid green";
              let resultElement = document.createElement("div");
              resultElement.className = "validation-result valid";
              resultElement.innerHTML = resultText;
              resultDiv.appendChild(resultElement);
            } else {
              let suggestedValue = roundedComputed.toFixed(1);
              let resultText = `❌ <b>${nutrientNames[i-1]}</b>: 不符合。建議每份${nutrientNames[i-1]}應為 ${suggestedValue} ${fixedNutrientsUnit[nutrientNames[i-1]]}`;
              invalidCount++;
              servingValueInput.style.border = "2px solid red";
              let resultElement = document.createElement("div");
              resultElement.className = "validation-result invalid";
              resultElement.innerHTML = resultText;
              resultDiv.appendChild(resultElement);
            }
          }
        }
      }

      // 驗證額外新增營養素
      let extraRows = document.querySelectorAll(".extra-nutrient-row");
      extraRows.forEach(function(row) {
        let nutrientSelect = row.querySelector(".extra-nutrient-select");
        if(nutrientSelect.value.trim() === "") return;
        let nutrientName = nutrientSelect.value;
        let servingValueInput = row.querySelector(".extra-nutrient-serving");
        let per100ValueInput = row.querySelector(".extra-nutrient-per100");
        if (servingValueInput.value.trim() !== "" && per100ValueInput.value.trim() !== "") {
          let suggestion = checkNutrientDecimal(servingValueInput.value, nutrientName);
          if (suggestion !== "") {
            resultDiv.innerHTML += "<div class='validation-result warning'>⚠️ " + suggestion + "（" + nutrientName + " - 每份）</div>";
          }
          suggestion = checkNutrientDecimal(per100ValueInput.value, nutrientName);
          if (suggestion !== "") {
            resultDiv.innerHTML += "<div class='validation-result warning'>⚠️ " + suggestion + "（" + nutrientName + " - 每100" + document.getElementById("unitDisplay").innerText + "）</div>";
          }
          
          let nutrientPerServing = parseFloat(servingValueInput.value);
          let nutrientPer100 = parseFloat(per100ValueInput.value);
          if (isNaN(nutrientPerServing) || isNaN(nutrientPer100)) {
            let resultText = `❌ <b>${nutrientName}</b>: 輸入的數值錯誤`;
            invalidCount++;
            servingValueInput.style.border = "2px solid red";
            let resultElement = document.createElement("div");
            resultElement.className = "validation-result invalid";
            resultElement.innerHTML = resultText;
            resultDiv.appendChild(resultElement);
          } else {
            let precision = (servingValueInput.value.split(".")[1] || "").length;
            let computedValue = nutrientPer100 / (100 / servingSize);
            function roundToPrecision(value, precision) {
              return Number(value.toFixed(precision));
            }
            let roundedComputed = roundToPrecision(computedValue, precision);
            if (roundToPrecision(nutrientPerServing, precision) === roundedComputed) {
              let resultText = `✅ <b>${nutrientName}</b>: 完全符合 (${nutrientPerServing})`;
              validCount++;
              servingValueInput.style.border = "1px solid green";
              let resultElement = document.createElement("div");
              resultElement.className = "validation-result valid";
              resultElement.innerHTML = resultText;
              resultDiv.appendChild(resultElement);
            } else {
              let suggestedValue = roundedComputed.toFixed(1);
              let resultText = `❌ <b>${nutrientName}</b>: 不符合。建議每份${nutrientName}應為 ${suggestedValue} ${extraNutrientsList[nutrientName]}`;
              invalidCount++;
              servingValueInput.style.border = "2px solid red";
              let resultElement = document.createElement("div");
              resultElement.className = "validation-result invalid";
              resultElement.innerHTML = resultText;
              resultDiv.appendChild(resultElement);
            }
          }
        }
      });

      let summaryElement = document.createElement("div");
      summaryElement.style.marginTop = "10px";
      summaryElement.style.fontWeight = "bold";
      summaryElement.style.padding = "10px";
      summaryElement.style.borderRadius = "5px";
      if (invalidCount > 0) {
        summaryElement.style.backgroundColor = "#f8d7da";
        summaryElement.style.color = "#721c24";
        summaryElement.innerText = `驗證結果：${validCount} 項符合，${warningCount} 項可能符合，${invalidCount} 項不符合`;
      } else if (warningCount > 0) {
        summaryElement.style.backgroundColor = "#fff3cd";
        summaryElement.style.color = "#856404";
        summaryElement.innerText = `驗證結果：${validCount} 項符合，${warningCount} 項可能符合`;
      } else if (validCount > 0) {
        summaryElement.style.backgroundColor = "#d4edda";
        summaryElement.style.color = "#155724";
        summaryElement.innerText = `驗證結果：所有 ${validCount} 項數值皆完全符合標準！`;
      } else {
        summaryElement.style.backgroundColor = "#f8d7da";
        summaryElement.style.color = "#721c24";
        summaryElement.innerText = "請輸入數值以進行驗證";
      }
      resultDiv.appendChild(summaryElement);
      
      // 呼叫熱量驗證與其他公式驗證
      validateCalorieSum();
      validateAdditionalFormulas();
    }
  </script>
</body>
</html>

