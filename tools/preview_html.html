<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>å³æ™‚ HTML ç·¨è¼¯èˆ‡é è¦½å·¥å…·ï¼ˆå¯èª¿æ•´å¯¬åº¦ï¼‰</title>
  <style>
    :root{
      --bg: #0f172a; --panel: #111827ee; --muted: #94a3b8; --text: #e5e7eb;
      --accent: #22d3ee; --border: #1f2937; --highlight: #fde68a; --active: #60a5fa;
      --ok: #86efac;
      --left: 50%; --right: 50%;
    }
    [data-theme="light"]{
      --bg: #f8fafc; --panel: #ffffff; --muted: #6b7280; --text: #111827;
      --accent: #0284c7; --border: #d1d5db; --highlight: #facc15; --active: #2563eb;
      --ok: #16a34a;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--text);
      font:14px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Noto Sans,Helvetica,Arial;
      transition: background .3s, color .3s;}
    header{display:flex;align-items:center;gap:.75rem;justify-content:space-between;
      padding:.75rem 1rem;border-bottom:1px solid var(--border);
      background:var(--bg);position:sticky;top:0;z-index:10;flex-wrap:wrap;
      transition: background .3s;}
    .brand{display:flex;align-items:center;gap:.5rem}
    .brand .dot{width:10px;height:10px;border-radius:999px;background:var(--accent);box-shadow:0 0 12px var(--accent)}
    .brand h1{font-size:14px;margin:0;color:var(--text);letter-spacing:.5px}

    .toolbar{display:flex;gap:.5rem;flex-wrap:wrap;align-items:center}
    .toolbar button,.toolbar label,.toolbar input[type="text"],.toolbar input[type="range"]{
      background:var(--panel);border:1px solid var(--border);color:var(--text);
      padding:.45rem .6rem;border-radius:.6rem;font-size:13px;transition:background .3s,color .3s;}
    .toolbar input[type="range"]{width:160px;padding:.35rem}
    .stat{color:var(--muted);font-size:12px;padding:.45rem .6rem}

    .layout{display:grid;grid-template-columns: var(--left) 8px var(--right);
      gap:0;height:calc(100% - 76px)}
    .pane{display:flex;flex-direction:column;height:100%}
    .pane h2{margin:.5rem 0 .25rem .5rem;font-size:12px;color:var(--muted);font-weight:600;text-transform:uppercase;letter-spacing:.5px}

    .editor-wrap,.preview-wrap{flex:1;display:flex;flex-direction:column;gap:.5rem;padding:.5rem}
    textarea{flex:1;width:100%;resize:none;border-radius:.8rem;padding:1rem;background:var(--panel);
      color:var(--text);border:1px solid var(--border);font:13px/1.5 ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono",monospace;outline:none;transition:background .3s,color .3s;}
    .hint{color:var(--muted);font-size:12px;margin-left:.5rem}

    .preview-head{display:flex;align-items:center;gap:.5rem;flex-wrap:wrap}
    .preview-head input[type="text"]{flex:1;min-width:180px}
    iframe{flex:1;width:100%;border:1px solid var(--border);border-radius:.8rem;background:var(--panel);transition:background .3s;box-shadow:0 0 0 1px var(--border) inset}

    .splitter{background:var(--bg);position:relative;cursor:col-resize}
    .splitter::before{content:"";position:absolute;inset:0;border-left:1px solid var(--border);border-right:1px solid var(--border);opacity:.8}
    .splitter .grip{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:24px;height:40px;border-radius:8px;background:var(--panel);border:1px solid var(--border);display:flex;align-items:center;justify-content:center;opacity:.7}
    .splitter .grip::after{content:"â‹®";font-size:18px;color:var(--muted);letter-spacing:2px}
    .splitter:focus{outline:2px solid var(--active)}

    .badge{border:1px solid var(--border);padding:.2rem .5rem;border-radius:.5rem;color:var(--muted);font-size:12px}
    .count{color:var(--ok)}
    .footer{padding:.5rem 1rem;color:var(--muted);border-top:1px solid var(--border);font-size:12px;transition:background .3s,color .3s;}

    @media (max-width: 900px){
      .layout{grid-template-columns: 1fr; grid-template-rows: 1fr 8px 1fr}
      .splitter{cursor:row-resize}
    }
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <div class="dot"></div>
      <h1>å³æ™‚ HTML ç·¨è¼¯èˆ‡é è¦½å·¥å…· Â· å¯èª¿æ•´å¯¬åº¦</h1>
    </div>
    <div class="toolbar">
      <button id="btn-new" title="æ¸…ç©ºå…§å®¹ (Alt+N)">æ–°æª”</button>
      <input type="file" id="file-open" hidden accept=".html,.htm,.txt" />
      <button id="btn-open" title="é–‹å•Ÿæª”æ¡ˆ (Alt+O)">é–‹å•Ÿ</button>
      <button id="btn-save" title="ä¸‹è¼‰ (Ctrl/Cmd+S)">ä¸‹è¼‰</button>
      <button id="btn-format" title="ç°¡æ˜“æ’ç‰ˆ (Alt+F)">æ ¼å¼åŒ–</button>
      <label title="åˆ‡æ›è‡ªå‹•æ›´æ–° (Alt+U)"><input type="checkbox" id="auto-update" checked /> è‡ªå‹•æ›´æ–°</label>
      <label>å¯¬åº¦ï¼š<input id="split-range" type="range" min="20" max="80" value="50" step="1"/></label>
      <button id="split-reset">é‡ç½®æ¯”ä¾‹</button>
      <button id="toggle-theme" title="åˆ‡æ›èƒŒæ™¯ (Alt+B)">ğŸŒ“ åˆ‡æ›ä¸»é¡Œ</button>
      <span class="stat" id="status">å°±ç·’</span>
    </div>
  </header>

  <div class="layout" id="layout">
    <section class="pane">
      <h2>HTML åŸå§‹ç¢¼</h2>
      <div class="editor-wrap">
        <textarea id="editor" spellcheck="false" placeholder="åœ¨æ­¤è¼¸å…¥æˆ–è²¼ä¸Š HTML â€¦"></textarea>
        <div class="hint">âœ¦ å¿«æ·éµï¼š<kbd>Ctrl/Cmd + S</kbd> ä¸‹è¼‰ã€<kbd>Alt + U</kbd> è‡ªå‹•æ›´æ–°ã€<kbd>Alt + F</kbd> æ ¼å¼åŒ–ã€<kbd>Alt + R</kbd> é‡ç½®æ¯”ä¾‹ã€<kbd>Alt + B</kbd> åˆ‡æ›ä¸»é¡Œ</div>
      </div>
    </section>

    <div class="splitter" id="splitter" role="separator" aria-orientation="vertical" tabindex="0">
      <div class="grip" aria-hidden="true"></div>
    </div>

    <section class="pane">
      <h2>å³æ™‚é è¦½ & æ®µè½æœå°‹</h2>
      <div class="preview-wrap">
        <div class="preview-head">
          <input type="text" id="search" placeholder="æœå°‹æ®µè½å…§å®¹ï¼ˆæ”¯æ´ä¸åˆ†å¤§å°å¯«ï¼‰" />
          <button id="btn-prev">â–² ä¸Šä¸€å€‹</button>
          <button id="btn-next">â–¼ ä¸‹ä¸€å€‹</button>
          <span class="badge">ç¬¦åˆï¼š<span id="match-count" class="count">0</span></span>
          <span class="badge">ç›®å‰ï¼š<span id="match-index">-</span></span>
        </div>
        <iframe id="preview" sandbox="allow-scripts allow-modals"></iframe>
      </div>
    </section>
  </div>

  <div class="footer">æœ¬å·¥å…·ä¸æœƒä¸Šå‚³è³‡æ–™ï¼›ç·¨è¼¯å…§å®¹èˆ‡ç‰ˆé¢æ¯”ä¾‹èˆ‡ä¸»é¡Œè¨­å®šçš†æœƒæš«å­˜æ–¼ <code>localStorage</code>ã€‚</div>

<script>
(function(){
  const editor = document.getElementById('editor');
  const preview = document.getElementById('preview');
  const searchBox = document.getElementById('search');
  const statusEl = document.getElementById('status');
  const autoUpdate = document.getElementById('auto-update');
  const splitter = document.getElementById('splitter');
  const layout = document.getElementById('layout');
  const range = document.getElementById('split-range');
  const resetBtn = document.getElementById('split-reset');
  const btnTheme = document.getElementById('toggle-theme');

  let debounceTimer=null; let matches=[]; let current=-1;

  function setStatus(msg){
    statusEl.textContent = msg;
    clearTimeout(setStatus._t);
    setStatus._t = setTimeout(()=> statusEl.textContent = 'å°±ç·’', 1200);
  }

  // === ä¸»é¡Œåˆ‡æ› ===
  function applyTheme(theme){
    document.body.dataset.theme = theme;
    localStorage.setItem('livepad_theme', theme);
    setStatus(theme==='light'?'â˜€ï¸ å·²åˆ‡æ›ç‚ºç™½è‰²èƒŒæ™¯':'ğŸŒ™ å·²åˆ‡æ›ç‚ºæ·±è‰²èƒŒæ™¯');
  }
  btnTheme.addEventListener('click', ()=>{
    const newTheme = (document.body.dataset.theme === 'light') ? 'dark' : 'light';
    applyTheme(newTheme);
  });
  window.addEventListener('keydown',(e)=>{
    if(e.altKey && e.key.toLowerCase()==='b'){e.preventDefault();btnTheme.click();}
  });

  const savedTheme = localStorage.getItem('livepad_theme') || 'dark';
  applyTheme(savedTheme);

  // === æ¯”ä¾‹èª¿æ•´ ===
  function applySplit(leftPercent){
    const left=Math.max(20,Math.min(80,Math.round(leftPercent)));
    document.documentElement.style.setProperty('--left', left + '%');
    document.documentElement.style.setProperty('--right',(100-left)+'%');
    range.value=left; localStorage.setItem('livepad_split',left);
  }
  range.addEventListener('input',()=>applySplit(range.value));
  resetBtn.addEventListener('click',()=>applySplit(50));

  // === é è¦½æ›´æ–° ===
  function injectPreview(html){
    preview.srcdoc = `<!doctype html><html><head><meta charset="utf-8"></head><body>${html}</body></html>`;
  }
  function updatePreview(){ injectPreview(editor.value); }
  function debounceUpdate(){ if(!autoUpdate.checked)return; clearTimeout(debounceTimer); debounceTimer=setTimeout(updatePreview,250); }

  editor.addEventListener('input',()=>{ localStorage.setItem('livepad_html',editor.value); debounceUpdate(); });

  // === åˆå§‹åŒ– ===
  const savedHTML = localStorage.getItem('livepad_html') || "<h1>æ­¡è¿ä½¿ç”¨å³æ™‚ HTML ç·¨è¼¯å™¨ âœ¨</h1>";
  editor.value = savedHTML; updatePreview();
  const savedSplit = parseInt(localStorage.getItem('livepad_split')||'50',10);
  applySplit(isNaN(savedSplit)?50:savedSplit);
})();
</script>
</body>
</html>

